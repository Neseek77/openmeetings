<?xml version="1.0" encoding="UTF-8" ?>
<library>
 
 <class name="invitationquickloader" extends="labelexplorerbox" labelid="230"
    docking="true" resizeable="false" closable="false" width="324" x="300" y="0" height="120">
	 
	<attribute name="userlang" value="1" type="number" />

	<labeltext y="30" x="10" fontstyle="bold" labelid="229" />

    <handler name="oninit">
        Debug.write("this.parent: ",this.parent);
           
        parent.userlang = Number(parent.languages.getValue());
           
        var userObject = new Array();
           
        canvas.setAttribute('currentuser',canvas.mail);
        canvas.setAttribute('user_id',-1);
        canvas.setAttribute('firstName',"guest");
        canvas.setAttribute('lastName',"guest");	
        canvas.setAttribute('mail',canvas.mail);
        canvas.setAttribute('lastLogin','');
        canvas.setAttribute('official_code','');
        canvas.setAttribute('picture_uri','');
        canvas.setAttribute('language','');					
       
        userObject["login"] = canvas.mail;
        userObject["firstname"] = "guest";
        userObject["lastname"] = "guest";
        userObject["adresses"] = new Array();
        userObject["adresses"]["emails"] = new Array();
        userObject["adresses"]["emails"][0] = new Array();
        userObject["adresses"]["emails"][0]["mail"] = new Array();
        userObject["adresses"]["emails"][0]["mail"]["email"] = canvas.mail;
           
        hib.userobject = userObject;
           
        hib.userlang = Number(parent.languages.getValue());

        this.getLanguageById.doCall();
                  
    </handler>

    <netremotecallhib name="getLanguageById" funcname="xmlcrm.getLanguageById" 
		remotecontext="$once{ canvas.thishib }" >      
        <netparam name="vars1"><method name="getValue"> return parent.parent.userlang; </method></netparam> 
        <handler name="ondata" args="value">
            //The onResult-Handler will be called be the rtmpconnection
            Debug.write("getLanguageById: ",value);
            setLabelObject(value);
			parent.getStates.doCall();
        </handler>  
    </netremotecallhib>	 
	 
    
    <netremotecallhib name="getStates" funcname="xmlcrm.getStates" 
		remotecontext="$once{ canvas.thishib }" >  
        <handler name="ondata" args="value">
            //The onResult-Handler will be called be the rtmpconnection
            Debug.write("getStates: ",value);
            canvas.statesInitValues = value;
            parent.getUserSalutations.doCall();
        </handler>  
    </netremotecallhib>    
    
    <netremotecallhib name="getUserSalutations" funcname="userservice.getUserSalutations" 
		remotecontext="$once{ canvas.thishib }" >  
		<netparam name="vars1"><method name="getValue">return canvas.sessionId;</method></netparam>
        <handler name="ondata" args="value">
            //The onResult-Handler will be called be the rtmpconnection
            Debug.write("getUserSalutations ",value);
            canvas.salutationsInitValues = value;
            parent.getRoomTypes.doCall();
        </handler>  
    </netremotecallhib>   
    
    <netremotecallhib name="getRoomTypes" funcname="conferenceservice.getRoomTypes" 
		remotecontext="$once{ canvas.thishib }" >  
		<netparam name="vars1"><method name="getValue">return canvas.sessionId;</method></netparam>
        <handler name="ondata" args="value">
            //The onResult-Handler will be called be the rtmpconnection
            Debug.write("getRoomTypes ",value);
            canvas.roomTypesInitValues = value;
            parent.setUsername.doCall();
        </handler>  
    </netremotecallhib>    	 

	 
    <netremotecallhib name="setUsername" funcname="setUsername" remotecontext="$once{ canvas.thishib }" >   
        <netparam name="vars1"><method name="getValue">return canvas.user_id;</method></netparam>
        <netparam name="vars2"><method name="getValue">return canvas.currentuser;</method></netparam>
        <netparam name="vars3"><method name="getValue">return canvas.firstName;</method></netparam>
        <netparam name="vars4"><method name="getValue">return canvas.lastName;</method></netparam>      
        <netparam name="vars6"><method name="getValue">return parent.parent.currentdomain;</method></netparam>
        <handler name="ondata" args="value">
            //The onResult-Handler will be called be the rtmpconnection
            Debug.write("setUsername: ",value);
	        hib.connectedroom=canvas.initroomid;
            hib.conferencedomain = canvas.initdomainid;

            Debug.write("hib.conferencedomain: ",hib.conferencedomain);
            clearStageContent();
            canvas._mainbgcontentNavi.navi._innercontent.clearAllSubItemLists(); 			
			if (canvas.initroomtype=="conference"){
				new conference(canvas.main_content._content.inner); 
			} else {
				new audience(canvas.main_content._content.inner); 
			}
			this.parent.close();	                 
        </handler>  
    </netremotecallhib>  
	  	 	
</class>
	
<!--

  -->

</library>