<?xml version="1.0" encoding="UTF-8" ?>
<library>
<!--  -->

<class name="pptlist" extends="view" width="260" height="270" bgcolor="0x4171B5">
	<view width="${ parent.width-2 }" height="${ parent.height-2 }" x="1" y="1" bgcolor="white" />

	<attribute name="uploadmodul" value="" type="string" />
<!-- 
    <handler name="oninit">
        this.addFile(1,'AAAA0051.JPG','','',true);
        this.addFile(2,'AAAA0104.JPG','','',true);
        this.addFile(3,'commons-httpclient-3.0.1.jar','','',false);
    </handler>
 -->
 
    <method name="addFile" args="filesid,filename,owner,inserted,isimage">
    	Debug.write("this.uploadmodul: ",this.uploadmodul);
        new listpptItem(this._table._listcontent,{uploadmodul:this.uploadmodul,filesid:filesid,filename:filename,owner:owner,inserted:inserted});
    </method>
    
    <method name="resetList">
    	this._table._listcontent.destroy();
    	new pptlistcontent(this._table,{name:'_listcontent'});
    </method>
    
    <view name="_table" width="${ parent.width-4 }" height="${ parent.height-4 }" x="2" y="2" clip="true">
        <pptlistcontent name="_listcontent" />
        <vscrollbar />
    </view>
</class>

<class name="pptlistcontent" extends="view" >
    <simplelayout name="_layout" axis="y" spacing="0" />
</class>

<class name="listpptItem" extends="view" bgcolor="0x4171B5" height="19" width="260" 
    onmouseover="this._textV.setBGColor(0x799FCE)" onmouseout="this._textV.setBGColor(white)" >

    <attribute name="filesid" value="" type="string" />
    <attribute name="filename" value="" type="string" />
    <attribute name="owner" value="" type="string" />
    <attribute name="inserted" value="" type="string" />
    
    <attribute name="uploadmodul" value="" type="string" />
    
    <view bgcolor="white" name="_textV" width="260" height="18" />
    <text name="_text" text="$once{ '     '+parent.filename }" width="170" fontsize="10" height="18" />
    
	<view resource="reload_small_rsc" x="1" onclick="parent.__LZFileAddConvert()" >
		<tooltip text="Add to whiteboard" />
	</view>
	
	<view resource="filesave_rsc" x="$once{ parent.parent.parent.width -54 }" onclick="parent.__LZFileDownload()" >
		<tooltip text="Download file" />
	</view>
	<view resource="close" x="$once{ parent.parent.parent.width -34 }" onclick="parent.__LZFileDelete()" >
		<tooltip text="Delete file" />
	</view>	
	<method name="__LZFileDownload">
		<![CDATA[
		Debug.write("Download File ",this);
		if (canvas.iswebrtmp){
			var downloadurl = '../../'+'lps-latest/DownloadHandler?fileName='+this.filename+'&moduleName='+this.uploadmodul;
        } else {
        	var downloadurl = '../../'+'DownloadHandler?fileName='+this.filename+'&moduleName='+this.uploadmodul;
        }
		Debug.write(downloadurl);	
		LzBrowser.loadURL(downloadurl,'_parent');	
		]]>
	</method>
	
	<attribute name="pptconversionmodalRef" value="null" />
	<method name="__LZFileDelete">
		this.deleteFile.invoke();
	</method>
	<!-- 
		<remotecall funcname="deleteFile" remotecontext="$once{ canvas.mainservices }">
			<param><method name="getValue"> return parent.parent.filename </method></param>
			<param><method name="getValue">return canvas.uploadmoduleppt;</method></param>
			<param><method name="getValue">return canvas.uploadmoduleimgfolder;</method></param>
	        <handler name="ondata" args="value">	
	        	Debug.write("  deleteFile: ",value);     
                canvas.mainservices.getListOfFiles.invoke();  	          				
	        </handler> 
	 	</remotecall>   
	  -->
    <tooltip text="Drag this image to the stag / right click to download" />
    <method name="__LZFileAddConvert">
    	this.pptconversionmodalRef = new pptconversionmodal(canvas);
    	this.createPptToPng.invoke();
    </method>
    	<!-- 
		<remotecall funcname="createPptToPng" remotecontext="$once{ canvas.mainservices }">
			<param><method name="getValue"> return parent.parent.filename </method></param>
			<param><method name="getValue">return canvas.uploadmoduleimg;</method></param>
	        <handler name="ondata" args="value">	
	        	Debug.write("  deleteFile: ",value);     
	        	this.parent.pptconversionmodalRef.close();
                canvas.mainservices.getListOfPptFiles.invoke();	          				
	        </handler> 
	 	</remotecall>       
	 	 -->
</class>

<class name="pptconversionmodal" extends="explorerbox" title="Dokeos VideoConference"
    docking="true" resizeable="false" closable="true" width="224" x="100" y="400" height="50">
    
	<method event="oninit">
		LzModeManager.makeModal(this);
	</method>
    <method event="onclose">
        LzModeManager.release(this);
    </method>

	<text y="30" x="10" fontsize="10" fontstyle="bold" text="Converting is in progress please wait" />
		
</class>

</library>
