<?xml version="1.0" encoding="UTF-8" ?>
<canvas debug="true" width="980" height="568">

<security>
	<allow>
		<pattern>^org.dokeos.servlets.*</pattern>
	</allow>
</security>

<attribute name="fileName" value="Tutorat.ppt" type="string" />
<attribute name="moduleName" value="videoconf1ppt" type="string" />

<javarpc name="mainservices" scope="session" objectreturntype="javabean" loadoption="create"
    autoload="true" classname="org.dokeos.servlets.DokeosRemote">
        <handler name="onload">
        	Debug.write("loaded");          
        </handler>
        <handler name="onerror" args="error">
            Debug.write(' E_RROR:', error);
        </handler>  
		<remotecall funcname="createPptToPng" >
			<param>
				<method name="getValue">
					return canvas.fileName;
				</method>
			</param>
			<param>
				<method name="getValue">
					return canvas.moduleName;
				</method>
			</param>			
	        <handler name="ondata" args="value">	
	        	Debug.write("  getListOfFiles: ",value);     
                Debug.write("getFiles: ",value);
                _imageslistdraw.resetList();
                for(eg in value){
                    Debug.write(value[eg]);   
                    var Teil = value[eg][0].substr(value[eg][0].length-3, value[eg][0].legnth);
                    var teil = Teil.toLowerCase();
                    Debug.write("Teil",teil);
                    var isimage = false;
                    if (teil=='jpg' || teil=='jpeg' || teil=='gif' || teil=='png') isimage=true;
                    _imageslistdraw.addFile(eg,value[eg][0],'admin',value[eg][1],isimage); 
                }	        	          				
	        </handler> 
	 	</remotecall>      	 	     
</javarpc>


<button>test ppt
	<handler name="onclick">
		canvas.mainservices.createPptToPng.invoke();
	</handler>
</button>

</canvas>