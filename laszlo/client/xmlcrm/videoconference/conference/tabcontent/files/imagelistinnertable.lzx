<?xml version="1.0" encoding="UTF-8"?>
<library>
	
<class name="imagelistinnertable" extends="view" width="$once{ parent.width-4 }" height="$once{ parent.height-4 }" 
	bgcolor="white" x="2" y="2" clip="true">
    <view name="_listcontent" bgcolor="$once{ canvas.basebgcolorizer }">
        <simplelayout name="_layout" axis="y" spacing="1" inset="1" />
        
	  	<netremotecallhib name="deleteFile" funcname="fileservice.deleteFile" remotecontext="$once{ canvas.thishib }" >   
			<netparam name="vars1"><method name="getValue"> return canvas.sessionId; </method></netparam>
	  		<netparam><method name="getValue">return parent.String1;</method></netparam>
        	<netparam><method name="getValue">return canvas.uploadmoduleimg;</method></netparam>
			<netparam><method name="getValue">return parent.String2;</method></netparam>
			<netparam><method name="getValue">return hib.connectedroom;</method></netparam>        	
			<netparam><method name="getValue">return hib.conferencedomain;</method></netparam>  
	        <handler name="ondata" args="value">	
	        	Debug.write("  deleteFile: ",value);  
				Debug.write("  deleteFile: ",this.String1);    
				Debug.write("  deleteFile: ",this.String2);   
		  		var tempSendArray = new Array ();
		  		tempSendArray[0] = 'fileslist';
		  		var nowTime = new Date();
		  		var datumsString = nowTime.getHours()+':'+nowTime.getMinutes();
		  		tempSendArray[1] = datumsString;
	  			Debug.write("Setting Message");
	  			tempSendArray[2] = 'newfile';
	  			tempSendArray[3] = canvas.currentusename;
		  		Debug.write("send: ",tempSendArray);
		  		canvas.objMessage = tempSendArray;
		  		hib.sendMessage.doCall();         	          				
	        </handler>	
	  	</netremotecallhib> 	
		
		<method name="getconfirmationscode">
			var t = new sharedobject();
			 t.getLocal('userdata');
			 var g = t.getData('userdata');
			 if (g==null) g = new Array();
			 if (g["wmlfile"]==null) {
				 g["wmlfile"]=new Array();
				 g["wmlfile"]["clearField"]=false;
				 g["wmlfile"]["askagainclear"]=true;
				 t.setData('userdata',g);
				 t.flush();          	
			 }
			 return g["wmlfile"];
		</method>
		
		<method name="resetDefaultConfirmations">
			var t = new sharedobject();
			 t.getLocal('userdata');
			 var g = t.getData('userdata');
			 if (g==null) g = new Array();
			 if (g["wmlfile"]==null) g["wmlfile"]=new Array();
			 g["wmlfile"]["clearField"]=false;
			 g["wmlfile"]["askagainclear"]=true;
			 t.setData('userdata',g);
			 t.flush();          	
	
		</method>	
		
		<method name="sendConfirmation" args="yesno,askagain" >
			
			Debug.write("clear yesno,askagain: ",yesno,askagain);
			//can only be true in this case
		
			 var t = new sharedobject();
			 t.getLocal('userdata');
			 var g = t.getData('userdata');
			 if (g==null) g = new Array();
			 if (g["wmlfile"]==null) g["wmlfile"]=new Array();
			 g["wmlfile"]["clearField"]=yesno;
			 g["wmlfile"]["askagainclear"]=!askagain;
			 t.setData('userdata',g);
			 t.flush(); 	
	
			 if (yesno){
				 Debug.write("clear field!!");
				_drawarea.setModus('plain');
				this.loadWmlObject.doCall();
			 }
		</method>				
		
		<method name="loadWmlObjectConfirm">
			<![CDATA[
			var storedImageDate = this.getconfirmationscode();
			Debug.write(" g[wmlfile] ",storedImageDate);
			if (storedImageDate["clearField"] && !storedImageDate["askagainclear"]){
				_drawarea.setModus('plain');
				this.loadWmlObject.doCall();
			} else if (!storedImageDate["askagainclear"] && !storedImageDate["clearField"]){
				//this case will never happen
				this.loadWmlObject.doCall();
			} else if (storedImageDate["askagainclear"]){
				new confirmationsingle(canvas.main_content._content.inner,{labelid:210,labeliderror:211,refObj:this});
			} else {
				new confirmationsingle(canvas.main_content._content.inner,{labelid:210,labeliderror:211,refObj:this});
			}
			]]>
		</method>
		
	  	<netremotecallhib name="loadWmlObject" funcname="fileservice.loadWmlObject" remotecontext="$once{ canvas.thishib }" >   
			<netparam name="vars1"><method name="getValue"> return canvas.sessionId; </method></netparam>
			<netparam><method name="getValue">return hib.connectedroom;</method></netparam>        	
			<netparam><method name="getValue">return hib.conferencedomain;</method></netparam>  
			  <netparam><method name="getValue">return parent.String1;</method></netparam>
	        <handler name="ondata" args="value">	
				<![CDATA[
					Debug.write("  loadWmlObject ",value); 
					_drawarea.loadwmlObjectToStage(value,this.String1,hib.connectedroom,hib.conferencedomain,true,false);
				]]>       	     				
	        </handler>	
	  	</netremotecallhib>
        

		 	 
    </view>
    <vscrollbar />
</class>

</library>