#summary OpenOffice Converter Installation instructions
#labels Phase-Documentation,Installation

= Linux (Debian,Ubuntu) =

= Open Office 2.4 Debian, Ubuntu= 
There are some improvements related to Openoffice 2.4 version. If you have to run old versions of Openoffice for any reason, please find the old section below. With 2.4, no more xvfb framebuffer needed.

===Installation steps (based on Etch 4.0 i386)===
  # Set backports for packages
  * Check your Debian version, find suitable backport source
  * vi(or nano or pico or your very favorite editor) /etc/apt/sources.list
  * add this line
  * deb http://www.backports.org/debian etch-backports main contrib non-free
  * run apt-get update

  # Install packages
  * Be sure all packages tagged with 2.4.0-4~bpo40+1
  * openoffice.org-headless, 
  * openoffice.org-writer, openoffice.org-calc, openoffice.org-impress, openoffice.org-draw, openoffice.org-math, openoffice.org-filter-mobiledev, openoffice.org-filter-binfilter, msttcorefonts, pstoedit, libpaper-utils, ttf-dejavu

  # Write startup script for test
  * vi ooo.sh
  
{{{ 
unset DISPLAY
sudo -H -u userx /usr/lib/openoffice/program/soffice "-accept=socket,host=localhost,port=8100;urp;StarOffice.ServiceManager" -nologo -headless -nofirststartwizard
}}}
  * chmod +x ooo.sh

  # Run the oOo server
  * sh ooo.sh
  * Check if server started with `netstat -an | grep 8100`
  * Should seem like `tcp        0      0 127.0.0.1:8100          0.0.0.0:*               LISTEN`

  # Test the conversion from command line 
  * cd  /usr/lib/red5/webapps/openmeetings/jod/
  * cp /home/userx/testme.ppt . (figure out the copy ppt file to your server, winscp?)
  * java -jar jodconverter-cli-2.2.0.jar -f pdf testme.ppt

{{{
com.artofsolving.jodconverter.openoffice.connection.AbstractOpenOfficeConnection connect
INFO: connected
com.artofsolving.jodconverter.openoffice.connection.AbstractOpenOfficeConnection disposing
INFO: disconnected
}}}

  # Login to openmeetings and check the conversion from there too.
  * 



    



  











= Install Open Office Service on Debian/(K)Ubuntu =
  # Install OpenOffice
{{{
sudo apt-get install xvfb openoffice.org
}}}
  # Edit /usr/lib/openoffice/share/registry/data/org/openoffice/Setup.xcu
  # After <node oor:name="Office"> insert the following lines:
{{{
<prop oor:name="ooSetupConnectionURL" oor:type="xs:string">
   <value>socket,host=localhost,port=8100;urp</value>
</prop>
}}}
  # Launch :
{{{
xvfb-run --server-args='-screen 0 800x600x16' -a /usr/lib/openoffice/program/soffice -headless -nologo -norestore
}}}

NOTE: Since !OpenOffice 2.3 comes already with an build-in !FrameBuffer there is no need for xvfb anymore.


= Mac OSx =
Install Open-Office from the Open-Office webside
Normally it is installed into your Application folder.
Goto file:
/Applications/OpenOffice.org\ 2.0.app/Contents/MacOS/share/registry/data/org/openoffice/Setup.xpu

add the following after the node *<node oor:name="Office">                                                                                                                                                   *:
{{{
                <prop oor:name="ooSetupConnectionURL">                                                                                                                               
                        <value>                                                                                                                                                      
                            socket,host=localhost,port=8100;urp;StarOffice.ServiceManager                                                                                            
                        </value>                                                                                                                                                     
                </prop>  
}}}

start x11/x-server (you can just start openoffice the normal way, close the openoffice app again but do NOT close the x-server/x-terminal, it will open a display for x11 on display :0)

open a new terminal and type:

sudo /Applications/OpenOffice.org\ 2.0.app/Contents/MacOS/program/soffice -display :0 -headless -nologo -norestore

OR

/Applications/OpenOffice.org\ 2.0.app/Contents/MacOS/program/soffice -display :0 -headless -nologo -norestore

sudo depends of your Red5 service .. if red5 is started as sudo (which must be started as sudo if the server is listening on port 80 (or smaller 1200) then ooservice also has to run as sudo cause it writes/reads from directories which red5 creates.

= Windows =
  * Install Open Office
  * Launch it one time (sothat you have filled the registrering form of Open Office which does only popup one time)
  * Open a Command-Prompt (CMD) and goto your Open Office Executable directory (for example ,,C:\Programme\OpenOffice.org 2.0\program,,)
  * Run Open Office in headless Modus with this command:
  ,,soffice.exe -headless -nologo -norestore -accept=socket,host=localhost,port=8100;urp;StarOffice.ServiceManager,,
  * check if its running by typing: ,,netstat -anp tcp,,
  you should find a line: 
    ,,TCP    127.0.0.1:8100         0.0.0.0:0              ABHÃ–REN,,

For more info see:
http://www.artofsolving.com/node/11


= Links =
  * http://www.artofsolving.com/node/10
  * http://wiki.conzul.de/index.php/OpenOffice2.x